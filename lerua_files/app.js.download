!function i(a,u,s){function c(t,e){if(!u[t]){if(!a[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(l)return l(t,!0);var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}var o=u[t]={exports:{}};a[t][0].call(o.exports,function(e){return c(a[t][1][e]||e)},o,o.exports,i,a,u,s)}return u[t].exports}for(var l="function"==typeof require&&require,e=0;e<s.length;e++)c(s[e]);return c}({1:[function(e,t,n){var s=Object.create||function(e){function t(){}return t.prototype=e,new t},a=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return n},i=Function.prototype.bind||function(e){var t=this;return function(){return t.apply(e,arguments)}};function r(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=s(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}((t.exports=r).EventEmitter=r).prototype._events=void 0,r.prototype._maxListeners=void 0;var o,u=10;try{var c={};Object.defineProperty&&Object.defineProperty(c,"x",{value:0}),o=0===c.x}catch(e){o=!1}function l(e){return void 0===e._maxListeners?r.defaultMaxListeners:e._maxListeners}function f(e,t,n,r){var o,i,a;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((i=e._events)?(i.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),i=e._events),a=i[t]):(i=e._events=s(null),e._eventsCount=0),a){if("function"==typeof a?a=i[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),!a.warned&&(o=l(e))&&0<o&&a.length>o){a.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+a.length+' "'+String(t)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=a.length,"object"==typeof console&&console.warn&&console.warn("%s: %s",u.name,u.message)}}else a=i[t]=n,++e._eventsCount;return e}function p(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var e=new Array(arguments.length),t=0;t<e.length;++t)e[t]=arguments[t];this.listener.apply(this.target,e)}}function h(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},o=i.call(p,r);return o.listener=n,r.wrapFn=o}function d(e,t,n){var r=e._events;if(!r)return[];var o=r[t];return o?"function"==typeof o?n?[o.listener||o]:[o]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(o):v(o,o.length):[]}function y(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function v(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}o?Object.defineProperty(r,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(e){if("number"!=typeof e||e<0||e!=e)throw new TypeError('"defaultMaxListeners" must be a positive number');u=e}}):r.defaultMaxListeners=u,r.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},r.prototype.getMaxListeners=function(){return l(this)},r.prototype.emit=function(e,t,n,r){var o,i,a,u,s,c,l="error"===e;if(c=this._events)l=l&&null==c.error;else if(!l)return!1;if(l){if(1<arguments.length&&(o=t),o instanceof Error)throw o;var f=new Error('Unhandled "error" event. ('+o+")");throw f.context=o,f}if(!(i=c[e]))return!1;var p="function"==typeof i;switch(a=arguments.length){case 1:!function(e,t,n){if(t)e.call(n);else for(var r=e.length,o=v(e,r),i=0;i<r;++i)o[i].call(n)}(i,p,this);break;case 2:!function(e,t,n,r){if(t)e.call(n,r);else for(var o=e.length,i=v(e,o),a=0;a<o;++a)i[a].call(n,r)}(i,p,this,t);break;case 3:!function(e,t,n,r,o){if(t)e.call(n,r,o);else for(var i=e.length,a=v(e,i),u=0;u<i;++u)a[u].call(n,r,o)}(i,p,this,t,n);break;case 4:!function(e,t,n,r,o,i){if(t)e.call(n,r,o,i);else for(var a=e.length,u=v(e,a),s=0;s<a;++s)u[s].call(n,r,o,i)}(i,p,this,t,n,r);break;default:for(u=new Array(a-1),s=1;s<a;s++)u[s-1]=arguments[s];!function(e,t,n,r){if(t)e.apply(n,r);else for(var o=e.length,i=v(e,o),a=0;a<o;++a)i[a].apply(n,r)}(i,p,this,u)}return!0},r.prototype.on=r.prototype.addListener=function(e,t){return f(this,e,t,!1)},r.prototype.prependListener=function(e,t){return f(this,e,t,!0)},r.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,h(this,e,t)),this},r.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,h(this,e,t)),this},r.prototype.removeListener=function(e,t){var n,r,o,i,a;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=s(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(o=-1,i=n.length-1;0<=i;i--)if(n[i]===t||n[i].listener===t){a=n[i].listener,o=i;break}if(o<0)return this;0===o?n.shift():function(e,t){for(var n=t,r=n+1,o=e.length;r<o;n+=1,r+=1)e[n]=e[r];e.pop()}(n,o),1===n.length&&(r[e]=n[0]),r.removeListener&&this.emit("removeListener",e,a||t)}return this},r.prototype.removeAllListeners=function(e){var t,n,r;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=s(null),this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=s(null):delete n[e]),this;if(0===arguments.length){var o,i=a(n);for(r=0;r<i.length;++r)"removeListener"!==(o=i[r])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=s(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)for(r=t.length-1;0<=r;r--)this.removeListener(e,t[r]);return this},r.prototype.listeners=function(e){return d(this,e,!0)},r.prototype.rawListeners=function(e){return d(this,e,!1)},r.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):y.call(e,t)},r.prototype.listenerCount=y,r.prototype.eventNames=function(){return 0<this._eventsCount?Reflect.ownKeys(this._events):[]}},{}],2:[function(require,module,exports){(function(global){var jc,kc;jc="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==global?global:this,kc=function(global){"use strict";global=global||{};var _Base64=global.Base64,version="2.5.1",buffer;if(void 0!==module&&module.exports)try{buffer=eval("require('buffer').Buffer")}catch(e){buffer=void 0}var b64chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b64tab=function(e){for(var t={},n=0,r=e.length;n<r;n++)t[e.charAt(n)]=n;return t}(b64chars),fromCharCode=String.fromCharCode,cb_utob=function(e){if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?fromCharCode(192|t>>>6)+fromCharCode(128|63&t):fromCharCode(224|t>>>12&15)+fromCharCode(128|t>>>6&63)+fromCharCode(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return fromCharCode(240|t>>>18&7)+fromCharCode(128|t>>>12&63)+fromCharCode(128|t>>>6&63)+fromCharCode(128|63&t)},re_utob=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,utob=function(e){return e.replace(re_utob,cb_utob)},cb_encode=function(e){var t=[0,2,1][e.length%3],n=e.charCodeAt(0)<<16|(1<e.length?e.charCodeAt(1):0)<<8|(2<e.length?e.charCodeAt(2):0);return[b64chars.charAt(n>>>18),b64chars.charAt(n>>>12&63),2<=t?"=":b64chars.charAt(n>>>6&63),1<=t?"=":b64chars.charAt(63&n)].join("")},btoa=global.btoa?function(e){return global.btoa(e)}:function(e){return e.replace(/[\s\S]{1,3}/g,cb_encode)},_encode=buffer?buffer.from&&Uint8Array&&buffer.from!==Uint8Array.from?function(e){return(e.constructor===buffer.constructor?e:buffer.from(e)).toString("base64")}:function(e){return(e.constructor===buffer.constructor?e:new buffer(e)).toString("base64")}:function(e){return btoa(utob(e))},encode=function(e,t){return t?_encode(String(e)).replace(/[+\/]/g,function(e){return"+"==e?"-":"_"}).replace(/=/g,""):_encode(String(e))},encodeURI=function(e){return encode(e,!0)},re_btou=new RegExp(["[ГЂ-Гџ][ВЂ-Вї]","[Г -ГЇ][ВЂ-Вї]{2}","[Г°-Г·][ВЂ-Вї]{3}"].join("|"),"g"),cb_btou=function(e){switch(e.length){case 4:var t=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return fromCharCode(55296+(t>>>10))+fromCharCode(56320+(1023&t));case 3:return fromCharCode((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return fromCharCode((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},btou=function(e){return e.replace(re_btou,cb_btou)},cb_decode=function(e){var t=e.length,n=t%4,r=(0<t?b64tab[e.charAt(0)]<<18:0)|(1<t?b64tab[e.charAt(1)]<<12:0)|(2<t?b64tab[e.charAt(2)]<<6:0)|(3<t?b64tab[e.charAt(3)]:0),o=[fromCharCode(r>>>16),fromCharCode(r>>>8&255),fromCharCode(255&r)];return o.length-=[0,0,2,1][n],o.join("")},_atob=global.atob?function(e){return global.atob(e)}:function(e){return e.replace(/\S{1,4}/g,cb_decode)},atob=function(e){return _atob(String(e).replace(/[^A-Za-z0-9\+\/]/g,""))},_decode=buffer?buffer.from&&Uint8Array&&buffer.from!==Uint8Array.from?function(e){return(e.constructor===buffer.constructor?e:buffer.from(e,"base64")).toString()}:function(e){return(e.constructor===buffer.constructor?e:new buffer(e,"base64")).toString()}:function(e){return btou(_atob(e))},decode=function(e){return _decode(String(e).replace(/[-_]/g,function(e){return"-"==e?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,""))},noConflict=function(){var e=global.Base64;return global.Base64=_Base64,e};if(global.Base64={VERSION:version,atob:atob,btoa:btoa,fromBase64:decode,toBase64:encode,utob:utob,encode:encode,encodeURI:encodeURI,btou:btou,decode:decode,noConflict:noConflict,__buffer__:buffer},"function"==typeof Object.defineProperty){var noEnum=function(e){return{value:e,enumerable:!1,writable:!0,configurable:!0}};global.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",noEnum(function(){return decode(this)})),Object.defineProperty(String.prototype,"toBase64",noEnum(function(e){return encode(this,e)})),Object.defineProperty(String.prototype,"toBase64URI",noEnum(function(){return encode(this,!0)}))}}return global.Meteor&&(Base64=global.Base64),void 0!==module&&module.exports?module.exports.Base64=global.Base64:"function"==typeof define&&define.amd&&define([],function(){return global.Base64}),{Base64:global.Base64}},"object"==typeof exports&&void 0!==module?module.exports=kc(jc):"function"==typeof define&&define.amd?define(kc):kc(jc)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(e,o,i){!function(e){var t;if("function"==typeof define&&define.amd&&(define(e),t=!0),"object"==typeof i&&(o.exports=e(),t=!0),!t){var n=window.Cookies,r=window.Cookies=e();r.noConflict=function(){return window.Cookies=n,r}}}(function(){function u(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var r in n)t[r]=n[r]}return t}function c(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function e(s){function a(){}function n(e,t,n){if("undefined"!=typeof document){"number"==typeof(n=u({path:"/"},a.defaults,n)).expires&&(n.expires=new Date(1*new Date+864e5*n.expires)),n.expires=n.expires?n.expires.toUTCString():"";try{var r=JSON.stringify(t);/^[\{\[]/.test(r)&&(t=r)}catch(e){}t=s.write?s.write(t,e):encodeURIComponent(String(t)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=encodeURIComponent(String(e)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var o="";for(var i in n)n[i]&&(o+="; "+i,!0!==n[i]&&(o+="="+n[i].split(";")[0]));return document.cookie=e+"="+t+o}}function t(e,t){if("undefined"!=typeof document){for(var n={},r=document.cookie?document.cookie.split("; "):[],o=0;o<r.length;o++){var i=r[o].split("="),a=i.slice(1).join("=");t||'"'!==a.charAt(0)||(a=a.slice(1,-1));try{var u=c(i[0]);if(a=(s.read||s)(a,u)||c(a),t)try{a=JSON.parse(a)}catch(e){}if(n[u]=a,e===u)break}catch(e){}}return e?n[e]:n}}return a.set=n,a.get=function(e){return t(e,!1)},a.getJSON=function(e){return t(e,!0)},a.remove=function(e,t){n(e,"",u(t,{expires:-1}))},a.defaults={},a.withConverter=e,a}(function(){})})},{}],4:[function(e,t,n){var r,o,i=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function s(t){if(r===setTimeout)return setTimeout(t,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{o="function"==typeof clearTimeout?clearTimeout:u}catch(e){o=u}}();var c,l=[],f=!1,p=-1;function h(){f&&c&&(f=!1,c.length?l=c.concat(l):p=-1,l.length&&d())}function d(){if(!f){var e=s(h);f=!0;for(var t=l.length;t;){for(c=l,l=[];++p<t;)c&&c[p].run();p=-1,t=l.length}c=null,f=!1,function(t){if(o===clearTimeout)return clearTimeout(t);if((o===u||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(t);try{o(t)}catch(e){try{return o.call(null,t)}catch(e){return o.call(this,t)}}}(e)}}function y(e,t){this.fun=e,this.array=t}function v(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new y(e,t)),1!==l.length||f||s(d)},y.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],5:[function(e,p,t){(function(t){"use strict";var n=setTimeout;function s(e){return Boolean(e&&void 0!==e.length)}function r(){}function i(e){if(!(this instanceof i))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],f(e,this)}function o(n,r){for(;3===n._state;)n=n._value;0!==n._state?(n._handled=!0,i._immediateFn(function(){var e=1===n._state?r.onFulfilled:r.onRejected;if(null!==e){var t;try{t=e(n._value)}catch(e){return void u(r.promise,e)}a(r.promise,t)}else(1===n._state?a:u)(r.promise,n._value)})):n._deferreds.push(r)}function a(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof i)return t._state=3,t._value=e,void c(t);if("function"==typeof n)return void f(function(e,t){return function(){e.apply(t,arguments)}}(n,e),t)}t._state=1,t._value=e,c(t)}catch(e){u(t,e)}}function u(e,t){e._state=2,e._value=t,c(e)}function c(e){2===e._state&&0===e._deferreds.length&&i._immediateFn(function(){e._handled||i._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)o(e,e._deferreds[t]);e._deferreds=null}function l(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function f(e,t){var n=!1;try{e(function(e){n||(n=!0,a(t,e))},function(e){n||(n=!0,u(t,e))})}catch(e){if(n)return;n=!0,u(t,e)}}i.prototype.catch=function(e){return this.then(null,e)},i.prototype.then=function(e,t){var n=new this.constructor(r);return o(this,new l(e,t,n)),n},i.prototype.finally=function(t){var n=this.constructor;return this.then(function(e){return n.resolve(t()).then(function(){return e})},function(e){return n.resolve(t()).then(function(){return n.reject(e)})})},i.all=function(t){return new i(function(r,o){if(!s(t))return o(new TypeError("Promise.all accepts an array"));var i=Array.prototype.slice.call(t);if(0===i.length)return r([]);var a=i.length;function u(t,e){try{if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if("function"==typeof n)return void n.call(e,function(e){u(t,e)},o)}i[t]=e,0==--a&&r(i)}catch(e){o(e)}}for(var e=0;e<i.length;e++)u(e,i[e])})},i.resolve=function(t){return t&&"object"==typeof t&&t.constructor===i?t:new i(function(e){e(t)})},i.reject=function(n){return new i(function(e,t){t(n)})},i.race=function(o){return new i(function(e,t){if(!s(o))return t(new TypeError("Promise.race accepts an array"));for(var n=0,r=o.length;n<r;n++)i.resolve(o[n]).then(e,t)})},i._immediateFn="function"==typeof t&&function(e){t(e)}||function(e){n(e,0)},i._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},p.exports=i}).call(this,e("timers").setImmediate)},{timers:8}],6:[function(e,t,n){"use strict";var i=Object.prototype.hasOwnProperty;function a(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(e){return null}}n.stringify=function(e,t){t=t||"";var n,r,o=[];for(r in"string"!=typeof t&&(t="?"),e)if(i.call(e,r)){if((n=e[r])||null!=n&&!isNaN(n)||(n=""),r=encodeURIComponent(r),n=encodeURIComponent(n),null===r||null===n)continue;o.push(r+"="+n)}return o.length?t+o.join("&"):""},n.parse=function(e){for(var t,n=/([^=?&]+)=?([^&]*)/g,r={};t=n.exec(e);){var o=a(t[1]),i=a(t[2]);null===o||null===i||o in r||(r[o]=i)}return r}},{}],7:[function(e,t,n){"use strict";t.exports=function(e,t){if(t=t.split(":")[0],!(e=+e))return!1;switch(t){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 21!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e}},{}],8:[function(s,e,c){(function(e,t){var r=s("process/browser.js").nextTick,n=Function.prototype.apply,o=Array.prototype.slice,i={},a=0;function u(e,t){this._id=e,this._clearFn=t}c.setTimeout=function(){return new u(n.call(setTimeout,window,arguments),clearTimeout)},c.setInterval=function(){return new u(n.call(setInterval,window,arguments),clearInterval)},c.clearTimeout=c.clearInterval=function(e){e.close()},u.prototype.unref=u.prototype.ref=function(){},u.prototype.close=function(){this._clearFn.call(window,this._id)},c.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},c.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},c._unrefActive=c.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;0<=t&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},c.setImmediate="function"==typeof e?e:function(e){var t=a++,n=!(arguments.length<2)&&o.call(arguments,1);return i[t]=!0,r(function(){i[t]&&(n?e.apply(null,n):e.call(null),c.clearImmediate(t))}),t},c.clearImmediate="function"==typeof t?t:function(e){delete i[e]}}).call(this,s("timers").setImmediate,s("timers").clearImmediate)},{"process/browser.js":4,timers:8}],9:[function(e,r,t){(function(i){"use strict";var h=e("requires-port"),d=e("querystringify"),a=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,n=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\S\s]*)/i,t=new RegExp("^[\\x09\\x0A\\x0B\\x0C\\x0D\\x20\\xA0\\u1680\\u180E\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u202F\\u205F\\u3000\\u2028\\u2029\\uFEFF]+");function y(e){return(e||"").toString().replace(t,"")}var v=[["#","hash"],["?","query"],function(e){return e.replace("\\","/")},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d+)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],u={hash:1,query:1};function b(e){var t,n=("undefined"!=typeof window?window:void 0!==i?i:"undefined"!=typeof self?self:{}).location||{},r={},o=typeof(e=e||n);if("blob:"===e.protocol)r=new m(unescape(e.pathname),{});else if("string"==o)for(t in r=new m(e,{}),u)delete r[t];else if("object"==o){for(t in e)t in u||(r[t]=e[t]);void 0===r.slashes&&(r.slashes=a.test(e.href))}return r}function g(e){e=y(e);var t=n.exec(e);return{protocol:t[1]?t[1].toLowerCase():"",slashes:!!t[2],rest:t[3]}}function m(e,t,n){if(e=y(e),!(this instanceof m))return new m(e,t,n);var r,o,i,a,u,s,c=v.slice(),l=typeof t,f=this,p=0;for("object"!=l&&"string"!=l&&(n=t,t=null),n&&"function"!=typeof n&&(n=d.parse),t=b(t),r=!(o=g(e||"")).protocol&&!o.slashes,f.slashes=o.slashes||r&&t.slashes,f.protocol=o.protocol||t.protocol||"",e=o.rest,o.slashes||(c[3]=[/(.*)/,"pathname"]);p<c.length;p++)"function"!=typeof(a=c[p])?(i=a[0],s=a[1],i!=i?f[s]=e:"string"==typeof i?~(u=e.indexOf(i))&&(e="number"==typeof a[2]?(f[s]=e.slice(0,u),e.slice(u+a[2])):(f[s]=e.slice(u),e.slice(0,u))):(u=i.exec(e))&&(f[s]=u[1],e=e.slice(0,u.index)),f[s]=f[s]||r&&a[3]&&t[s]||"",a[4]&&(f[s]=f[s].toLowerCase())):e=a(e);n&&(f.query=n(f.query)),r&&t.slashes&&"/"!==f.pathname.charAt(0)&&(""!==f.pathname||""!==t.pathname)&&(f.pathname=function(e,t){if(""===e)return t;for(var n=(t||"/").split("/").slice(0,-1).concat(e.split("/")),r=n.length,o=n[r-1],i=!1,a=0;r--;)"."===n[r]?n.splice(r,1):".."===n[r]?(n.splice(r,1),a++):a&&(0===r&&(i=!0),n.splice(r,1),a--);return i&&n.unshift(""),"."!==o&&".."!==o||n.push(""),n.join("/")}(f.pathname,t.pathname)),h(f.port,f.protocol)||(f.host=f.hostname,f.port=""),f.username=f.password="",f.auth&&(a=f.auth.split(":"),f.username=a[0]||"",f.password=a[1]||""),f.origin=f.protocol&&f.host&&"file:"!==f.protocol?f.protocol+"//"+f.host:"null",f.href=f.toString()}m.prototype={set:function(e,t,n){var r=this;switch(e){case"query":"string"==typeof t&&t.length&&(t=(n||d.parse)(t)),r[e]=t;break;case"port":r[e]=t,h(t,r.protocol)?t&&(r.host=r.hostname+":"+t):(r.host=r.hostname,r[e]="");break;case"hostname":r[e]=t,r.port&&(t+=":"+r.port),r.host=t;break;case"host":r[e]=t,/:\d+$/.test(t)?(t=t.split(":"),r.port=t.pop(),r.hostname=t.join(":")):(r.hostname=t,r.port="");break;case"protocol":r.protocol=t.toLowerCase(),r.slashes=!n;break;case"pathname":case"hash":if(t){var o="pathname"===e?"/":"#";r[e]=t.charAt(0)!==o?o+t:t}else r[e]=t;break;default:r[e]=t}for(var i=0;i<v.length;i++){var a=v[i];a[4]&&(r[a[1]]=r[a[1]].toLowerCase())}return r.origin=r.protocol&&r.host&&"file:"!==r.protocol?r.protocol+"//"+r.host:"null",r.href=r.toString(),r},toString:function(e){e&&"function"==typeof e||(e=d.stringify);var t,n=this,r=n.protocol;r&&":"!==r.charAt(r.length-1)&&(r+=":");var o=r+(n.slashes?"//":"");return n.username&&(o+=n.username,n.password&&(o+=":"+n.password),o+="@"),o+=n.host+n.pathname,(t="object"==typeof n.query?e(n.query):n.query)&&(o+="?"!==t.charAt(0)?"?"+t:t),n.hash&&(o+=n.hash),o}},m.extractProtocol=g,m.location=b,m.trimLeft=y,m.qs=d,r.exports=m}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{querystringify:6,"requires-port":7}],10:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=r(e("./lib/queue")),i=r(e("./lib/not_implemented")),a=e("./logger");function r(e){return e&&e.__esModule?e:{default:e}}function u(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l=function(){function r(e){var t=e.name,n=e.events;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.name=t,this.events=n,this.queue=new o.default,this.initialized=!1,this.logger=this.createLogger()}return function(e,t,n){t&&c(e.prototype,t),n&&c(e,n)}(r,[{key:"emit",value:function(e){for(var t,n=arguments.length,r=new Array(1<n?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return(t=this.events).emit.apply(t,[e].concat(r)),this}},{key:"on",value:function(e,t){return this.events.on(e,t),this}},{key:"createLogger",value:function(){return(0,a.createLogger)(this.name)}},{key:"call",value:function(){(0,i.default)(this,"call")}},{key:"queueCall",value:function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return this.logger.debug("Queue call",e,n),this.queue.push([e,n])}},{key:"processQueue",value:function(){var o=this;this.logger.debug("Queue processing..."),this.queue.process(function(e){var t=s(e,2),n=t[0],r=t[1];return o.call.apply(o,[n].concat(u(r)))}),this.logger.debug("Queue processed")}},{key:"initialize",value:function(){if(this.initialized)return!1;this.logger.debug("Initialization..."),this.onBeforeInitialize(),this.initialized=!0,this.logger.debug("Initialized"),this.processQueue(),this.onAfterInitialize()}},{key:"onBeforeInitialize",value:function(){}},{key:"onAfterInitialize",value:function(){}}]),r}();n.default=l},{"./lib/not_implemented":30,"./lib/queue":34,"./logger":38}],11:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getWindowWidth=y,n.getWindowHeight=v,n.getInfo=function(){return{platform:{name:o},browser:{name:i,version:a},window:{width:y(),height:v()}}},n.hasAnyXRSupport=n.hasXHRWithCreds=n.hasXHRSupport=n.hasXDRSupport=n.body=n.html=n.doc=n.win=void 0;var r=(0,e("./navigator").getInfo)(),o=r.platformName,i=r.browserName,a=r.browserVersion,u=window;n.win=u;var s=document;n.doc=s;var c=document.documentElement;n.html=c;var l=document.body;n.body=l;var f=!!window.XDomainRequest;n.hasXDRSupport=f;var p=!!u.XMLHttpRequest,h=(n.hasXHRSupport=p)&&"withCredentials"in new u.XMLHttpRequest;n.hasXHRWithCreds=h;var d=p||f;function y(){try{return u.innerWidth||c.clientWidth||l.clientWidth}catch(e){}}function v(){try{return u.innerHeight||c.clientHeight||l.clientHeight}catch(e){}}n.hasAnyXRSupport=d},{"./navigator":39}],12:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,o=(r=e("./lib/object_assign"))&&r.__esModule?r:{default:r},i=e("./page");function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}var s=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.merge(t.default),this.merge(e)}return u(t,null,[{key:"default",get:function(){return{transport:{server:"https://track.aplaut.io"},cookiePrefix:"aplaut_",cookieDomain:(0,i.getInfo)().domain,cookiePath:"/",localStoragePrefix:"aplaut_",sessionTimeout:1800}}}]),u(t,[{key:"merge",value:function(e){(0,o.default)(this,e)}}]),t}();n.default=s},{"./lib/object_assign":31,"./page":40}],13:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.EXPERIMENTS_COMPLETED_EVENT=n.EXPERIMENTS_RUNNED_EVENT=n.EXPERIMENTS_STARTED_EVENT=n.EXPERIMENTS_STORAGE_KEY=n.TRAITS_STORAGE_KEY=n.SESSION_STORAGE_KEY=n.DISTINCT_ID_STORAGE_KEY=void 0;n.DISTINCT_ID_STORAGE_KEY="distinct_id";n.SESSION_STORAGE_KEY="session";n.TRAITS_STORAGE_KEY="traits";n.EXPERIMENTS_STORAGE_KEY="experiments";n.EXPERIMENTS_STARTED_EVENT="experiments.started";n.EXPERIMENTS_RUNNED_EVENT="experiments.runned";n.EXPERIMENTS_COMPLETED_EVENT="experiments.completed"},{}],14:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=s(e("./../lib/sample")),o=(s(e("./../lib/object_assign")),s(e("./../lib/array_find"))),c=function(e){if(e&&e.__esModule)return e;var t=u();if(t&&t.has(e))return t.get(e);var n={};if(null!=e){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var i=r?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}}n.default=e,t&&t.set(e,n);return n}(e("./../lib/spec")),l=s(e("./variant")),f=s(e("./record")),i=s(e("./participation")),a=e("./../constants");function u(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return u=function(){return e},e}function s(e){return e&&e.__esModule?e:{default:e}}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var h=function(){function s(e){var t=e.name,n=e.variants,r=void 0===n?[]:n,o=e.options,i=e.storage,a=e.logger,u=e.events;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),this.name=c.require(t,{name:"Experiment name"}),this.variants=r.map(function(e){return new l.default(e)}),this.options=o||{},this.storage=i,this.logger=a,this.events=u,this.record=f.default.of(this)}return function(e,t,n){t&&p(e.prototype,t),n&&p(e,n)}(s,[{key:"perform",value:function(){return this.storage.available?this.record.isEmpty()||this.record.isInvalid()?this.runFirstTime():!0===this.record.participates?this.run():void 0:(this.logger.error("Storage is not available. Cancel the experiment"),!1)}},{key:"complete",value:function(){return this.record.isEmpty()||(this.events.emit(a.EXPERIMENTS_COMPLETED_EVENT,{experiment:this}),this.record.reset()),this}},{key:"runFirstTime",value:function(){if(this.shouldParticipate()){var e=this.chooseVariant();this.record.update({participates:!0,variantName:e.name}),this.events.emit(a.EXPERIMENTS_STARTED_EVENT,{experiment:this,variant:e}),this.useVariant(e)}else this.record.update({participates:!1})}},{key:"run",value:function(){var e=this.findVariant(this.record.variantName)||this.findDefaultVariant();this.useVariant(e)}},{key:"useVariant",value:function(e){return this.events.emit(a.EXPERIMENTS_RUNNED_EVENT,{experiment:this,variant:e}),e.use()}},{key:"shouldParticipate",value:function(){return new i.default({audience:this.options.audience,sample:this.options.sample}).determine()}},{key:"chooseVariant",value:function(){return(0,r.default)(this.variants)}},{key:"findVariant",value:function(t){return t&&(0,o.default)(this.variants,function(e){return e.name==t})}},{key:"findDefaultVariant",value:function(){var e=this.options.defaultVariantName;return e&&this.findVariant(e)||this.variants[0]}}]),s}();n.default=h},{"./../constants":13,"./../lib/array_find":20,"./../lib/object_assign":31,"./../lib/sample":36,"./../lib/spec":37,"./participation":15,"./record":16,"./variant":17}],15:[function(e,t,n){"use strict";function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(){function r(e){var t=e.audience,n=e.sample;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.audience=t,this.sample=n}return function(e,t,n){t&&o(e.prototype,t),n&&o(e,n)}(r,[{key:"determine",value:function(){return this.audience?this.tryAudience():!this.sample||this.trySample()}},{key:"tryAudience",value:function(){return this.audience()}},{key:"trySample",value:function(){return this.sample>=Math.random()}}]),r}();n.default=r},{}],16:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("./../constants");function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}var a=function(){function o(e){var t=e.experimentName,n=e.storage,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),this.experimentName=t,this.storage=n,this.storageKey=this.makeStorageKey(),this.merge(r)}return i(o,null,[{key:"of",value:function(e){var t=new o({experimentName:e.name,storage:e.storage});return t.load(),t}}]),i(o,[{key:"isValid",value:function(){return!this.participates||!!this.variantName}},{key:"isInvalid",value:function(){return!this.isValid()}},{key:"merge",value:function(e){var t=e.participates,n=e.variantName;return this.participates=t,this.variantName=n,this}},{key:"update",value:function(e){this.merge(e),this.save()}},{key:"makeStorageKey",value:function(){return[r.EXPERIMENTS_STORAGE_KEY,this.experimentName].join(":")}},{key:"isEmpty",value:function(){return void 0===this.participates}},{key:"load",value:function(){this.merge(this.storage.get(this.storageKey)||{})}},{key:"save",value:function(){this.storage.set(this.storageKey,this.toParams())}},{key:"reset",value:function(){this.storage.remove(this.storageKey)}},{key:"toParams",value:function(){return{participates:this.participates,variantName:this.variantName}}}]),o}();n.default=a},{"./../constants":13}],17:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=function(){function o(e){var t=e.name,n=e.changes,r=e.share;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),this.name=t,this.changes=n,this.share=r}return function(e,t,n){t&&r(e.prototype,t),n&&r(e,n)}(o,[{key:"use",value:function(){if("function"==typeof this.changes)return this.changes()}}]),o}();n.default=o},{}],18:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=i(e("./experiments/experiment")),o=i(e("./lib/object_assign")),a=i(e("./lib/array_includes")),u=i(e("./base_app")),s=i(e("./lib/no_method"));function i(e){return e&&e.__esModule?e:{default:e}}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var d=function(){function i(e){var t,n=e.events,r=e.config,o=e.storage;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=f(this,p(i).call(this,{name:"Aplaut Experiments",events:n}))).config=r,t.storage=o,t.publicMethods=["perform","complete"],t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(i,u.default),function(e,t,n){t&&l(e.prototype,t),n&&l(e,n)}(i,[{key:"call",value:function(e){for(var t,n=arguments.length,r=new Array(1<n?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return(t=this.logger).debug.apply(t,["call",e].concat(r)),this.hasMethod(e)?this.initialized?this[e].apply(this,r):this.queueCall.apply(this,[e].concat(r)):(0,s.default)(this.name,e)}},{key:"hasMethod",value:function(e){return(0,a.default)(this.publicMethods,e)}},{key:"perform",value:function(e,t,n){return this.newExperiment({name:e,variants:t,options:n}).perform()}},{key:"complete",value:function(e){return this.newExperiment({name:e}).complete()}},{key:"newExperiment",value:function(e){var t=0<arguments.length&&void 0!==e?e:{};return new r.default((0,o.default)({},t,{storage:this.storage,logger:this.logger,events:this.events}))}}]),i}();n.default=d},{"./base_app":10,"./experiments/experiment":14,"./lib/array_includes":21,"./lib/no_method":29,"./lib/object_assign":31}],19:[function(e,t,n){"use strict";var r=i(e("./lib/dom_ready")),o=i(e("./root_app"));function i(e){return e&&e.__esModule?e:{default:e}}(0,r.default)(function(){new o.default({globalName:"Aplaut"}).initialize()})},{"./lib/dom_ready":24,"./root_app":41}],20:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,t){if(!(0,o.default)(e))throw new TypeError;for(var n=0;n<e.length;n++){var r=e[n];if(t(r,n))return r}};var r,o=(r=e("./is_array"))&&r.__esModule?r:{default:r}},{"./is_array":26}],21:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,t){return!!~e.indexOf(t)}},{}],22:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("js-base64");r.Base64.noConflict();var o=r.Base64;n.default=o},{"js-base64":2}],23:[function(e,t,n){"use strict";function r(){return new Date}function o(){return r().getTime()}Object.defineProperty(n,"__esModule",{value:!0}),n.now=r,n.nowUnixMilliseconds=o,n.nowUnixSeconds=function(){return Math.round(o()/1e3)},n.nowISO8601=function(){return r().toISOString()}},{}],24:[function(e,t,n){"use strict";var r,o,i,a,u,s;void 0!==t&&(t.exports=(o=[],i=document,a=i.documentElement.doScroll,u="DOMContentLoaded",(s=(a?/^loaded|^c/:/^loaded|^i|^c/).test(i.readyState))||i.addEventListener(u,r=function(){for(i.removeEventListener(u,r),s=1;r=o.shift();)r()}),function(e){s?setTimeout(e,0):o.push(e)}))},{}],25:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.generate=function(){return(0,o.default)(12)};var r,o=(r=e("./random_string"))&&r.__esModule?r:{default:r}},{"./random_string":35}],26:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)}},{}],27:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){return"function"==typeof e}},{}],28:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){return"object"===r(e)&&"function"!==e&&null!==e}},{}],29:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,t){throw new Error(function(e,t){return"Aplaut.js: ".concat(JSON.stringify(e),' has no method "').concat(t,'"')}(e,t))}},{}],30:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,t){throw new Error(function(e,t){return'Aplaut.js: Method "'.concat(t,'" is not implemented for ')+JSON.stringify(e)}(e,t))}},{}],31:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,l=(r=e("./object_keys"))&&r.__esModule?r:{default:r};var o=Object.assign||function(e,t){if(null!=e){for(var n=Object(e),r=1;r<arguments.length;r++){var o=arguments[r];if(null!=o)for(var i=(0,l.default)(Object(o)),a=0,u=i.length;a<u;a++){var s=i[a],c=Object.getOwnPropertyDescriptor(o,s);void 0!==c&&c.enumerable&&(n[s]=o[s])}}return n}};n.default=o},{"./object_keys":32}],32:[function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i,a,u,s,r=Object.keys||(i=Object.prototype.hasOwnProperty,a=!{toString:null}.propertyIsEnumerable("toString"),s=(u=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]).length,function(e){if("function"!=typeof e&&("object"!==o(e)||null===e))throw new TypeError("Object.keys called on non-object");var t=[];for(var n in e)i.call(e,n)&&t.push(n);if(a)for(var r=0;r<s;r++)i.call(e,u[r])&&t.push(u[r]);return t});n.default=r},{}],33:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){if(!(0,a.default)(e))return e;for(var t=(0,u.default)({},e),n=arguments.length,r=new Array(1<n?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];for(var i in r)delete t[i];return t};var a=r(e("./is_object")),u=r(e("./object_assign"));function r(e){return e&&e.__esModule?e:{default:e}}},{"./is_object":28,"./object_assign":31}],34:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.items=e}return function(e,t,n){t&&r(e.prototype,t),n&&r(e,n)}(t,[{key:"push",value:function(e){return this.items.push(e),this}},{key:"pop",value:function(){return this.items.shift()}},{key:"isEmpty",value:function(){return 0==this.items.length}},{key:"process",value:function(e){for(;!this.isEmpty();){e(this.pop())}}}]),t}();n.default=o},{}],35:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:r;return Array(e).join().split(",").map(function(){return t.charAt(Math.floor(Math.random()*t.length))}).join("")};var r="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"},{}],36:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){var t=Math.floor(Math.random()*e.length);return e[t]}},{}],37:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.require=function(e,t){return null==e||""===e?function(e,t,n){var r=function(e){return(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).name||"Value ".concat(e)}(e,n);throw new Error("Aplaut.js: ".concat(r," ").concat(t))}(e,"is required",t):e}},{}],38:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.createLogger=r,n.default=void 0;e("./browser");function o(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function i(e,t,n){var r;"console"in window&&e in console&&(n&&t.unshift(n),(r=console)[e].apply(r,o(t)))}function r(t){function o(){var e=(new Date).toISOString().substr(11);return"".concat(e," ").concat(t,":")}function e(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];i("log",t,o())}return["log","info","debug","warn","error"].forEach(function(r){e[r]=function(){if("debug"!=r){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];i(r,t,o())}}}),e}var a=r("Aplaut");n.default=a},{"./browser":11}],39:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getInfo=function(){try{navigator.appVersion;var e,t,n,r=navigator.userAgent,o=navigator.appName,i=""+parseFloat(navigator.appVersion),a=parseInt(navigator.appVersion,10);return-1!=(t=r.indexOf("OPR/"))?(o="Opera",i=r.substring(t+4)):-1!=(t=r.indexOf("Opera"))?(o="Opera",i=r.substring(t+6),-1!=(t=r.indexOf("Version"))&&(i=r.substring(t+8))):-1!=(t=r.indexOf("MSIE"))?(o="Microsoft Internet Explorer",i=r.substring(t+5)):-1!=(t=r.indexOf("Chrome"))?(o="Chrome",i=r.substring(t+7)):-1!=(t=r.indexOf("Safari"))?(o="Safari",i=r.substring(t+7),-1!=(t=r.indexOf("Version"))&&(i=r.substring(t+8))):-1!=(t=r.indexOf("Firefox"))?(o="Firefox",i=r.substring(t+8)):(e=r.lastIndexOf(" ")+1)<(t=r.lastIndexOf("/"))&&(o=r.substring(e,t),i=r.substring(t+1),o.toLowerCase()==o.toUpperCase()&&(o=navigator.appName)),-1!=(n=i.indexOf(";"))&&(i=i.substring(0,n)),-1!=(n=i.indexOf(" "))&&(i=i.substring(0,n)),a=parseInt(""+i,10),isNaN(a)&&(i=""+parseFloat(navigator.appVersion),a=parseInt(navigator.appVersion,10)),{platformName:navigator.platform,browserName:o,browserVersion:a}}catch(e){}}},{}],40:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getInfo=function(){var e=(0,o.default)(i.win.location.href);return{url:e.toString(),scheme:e.protocol.substr(0,e.protocol.length-1),path:e.pathname,query:e.query,domain:e.hostname}};var r,o=(r=e("url-parse"))&&r.__esModule?r:{default:r},i=e("./browser")},{"./browser":11,"url-parse":9}],41:[function(v,e,b){(function(n){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.default=void 0;var o=r(v("events")),i=r(v("./tracking_app")),a=r(v("./experiments_app")),e=r(v("./base_app")),u=r(v("./config")),t=r(v("./storage/local_storage")),s=r(v("./storage/cookie_storage"));r(v("./storage/memory_storage"));function r(e){return e&&e.__esModule?e:{default:e}}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var y=function(){function r(e){var t,n=e.globalName;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=p(this,h(r).call(this,{name:"Root App",events:new o.default}))).globalName=n,t.config=new u.default,t.initializeStorage(),t.trackingApp=new i.default({events:t.events,config:t.config,cookieStorage:t.cookieStorage,localStorage:t.localStorage}),t.experimentsApp=new a.default({events:t.events,config:t.config,storage:t.localStorage}),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(r,e.default),function(e,t,n){t&&f(e.prototype,t),n&&f(e,n)}(r,[{key:"call",value:function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o,i;{if("configure"!=e)return"experiment"!=e?(o=this.trackingApp).call.apply(o,[e].concat(n)):(i=this.experimentsApp).call.apply(i,n);this.configure.apply(this,n)}}},{key:"configure",value:function(e){return this.config.merge(e)}},{key:"onBeforeInitialize",value:function(){this.provide()}},{key:"onAfterInitialize",value:function(){this.trackingApp.initialize(),this.experimentsApp.initialize()}},{key:"provide",value:function(){var t=this,e=this.globalName;n[e]&&n[e]._queue&&(n[e]._queue.forEach(function(e){try{t.call.apply(t,l(e))}catch(e){t.logger.error(e)}}),n[e]._queue=[]),n[e]._call=this.call.bind(this)}},{key:"initializeStorage",value:function(){this.localStorage=new t.default({prefix:this.config.localStoragePrefix}),this.cookieStorage=new s.default({prefix:this.config.cookiePrefix,domain:this.config.cookieDomain,path:this.config.cookiePath})}}]),r}();b.default=y}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./base_app":10,"./config":12,"./experiments_app":18,"./storage/cookie_storage":43,"./storage/local_storage":44,"./storage/memory_storage":45,"./tracking_app":50,events:1}],42:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=i(e("./../lib/object_assign")),o=i(e("./../lib/not_implemented"));function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.options=e}return function(e,t,n){t&&a(e.prototype,t),n&&a(e,n)}(t,[{key:"get",value:function(e){(0,o.default)(this,"get")}},{key:"set",value:function(e,t){(0,o.default)(this,"set")}},{key:"remove",value:function(e){(0,o.default)(this,"remove")}},{key:"has",value:function(e){return void 0!==this.get(e)}},{key:"update",value:function(e,t){return this.set(e,t(this.get(e)))}},{key:"setDefault",value:function(e,t){return this.update(e,function(e){return void 0===e?t:e})}},{key:"merge",value:function(e,t){return this.update(e,function(e){return(0,r.default)(e,t)})}},{key:"makeKey",value:function(e){return this.options.prefix?[this.options.prefix,e].join(""):e}}]),t}();n.default=u},{"./../lib/not_implemented":30,"./../lib/object_assign":31}],43:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=i(e("js-cookie")),o=i(e("./base_storage"));function i(e){return e&&e.__esModule?e:{default:e}}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=function(){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=s(this,c(n).call(this,e))).available=!0,t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(n,o.default),function(e,t,n){t&&u(e.prototype,t),n&&u(e,n)}(n,[{key:"get",value:function(e){return r.default.getJSON(this.makeKey(e))}},{key:"set",value:function(e,t){return r.default.set(this.makeKey(e),t,{expires:365,domain:this.options.domain,path:this.options.path}),this}},{key:"remove",value:function(e){return r.default.remove(this.makeKey(e),{domain:this.options.domain,path:this.options.path}),this}}]),n}();n.default=f},{"./base_storage":42,"js-cookie":3}],44:[function(f,e,p){(function(e){"use strict";Object.defineProperty(p,"__esModule",{value:!0}),p.default=void 0;var t,r=(t=f("./base_storage"))&&t.__esModule?t:{default:t},o=f("./../logger");function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var c=e.localStorage,l=function(){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=a(this,u(n).call(this,e))).logger=(0,o.createLogger)("localStorage"),t.available=t.checkAvailability(),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(n,r.default),function(e,t,n){t&&i(e.prototype,t),n&&i(e,n)}(n,[{key:"tryIfAvailable",value:function(e){if(this.available)try{return e.call(this)}catch(e){this.logger.error("Unexpected error ".concat(e.name,": ").concat(e.message))}else this.logger.warn("Is not available")}},{key:"get",value:function(e){var t=this;return this.tryIfAvailable(function(){return t.decode(c.getItem(t.makeKey(e)))})}},{key:"set",value:function(e,t){var n=this;return this.tryIfAvailable(function(){c.setItem(n.makeKey(e),n.encode(t))}),this}},{key:"remove",value:function(e){var t=this;return this.tryIfAvailable(function(){c.removeItem(t.makeKey(e))}),this}},{key:"checkAvailability",value:function(){try{var e="__aplaut_storage_test__";return c.setItem(e,e),c.removeItem(e),!0}catch(e){return!1}}},{key:"encode",value:function(e){return JSON.stringify(e)}},{key:"decode",value:function(t){try{return JSON.parse(t)}catch(e){this.logger.error("Can't parse ".concat(t," as JSON"))}}}]),n}();p.default=l}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./../logger":38,"./base_storage":42}],45:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,o=(r=e("./base_storage"))&&r.__esModule?r:{default:r};function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l=function(){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=u(this,s(n).call(this))).storage={},t.available=!0,t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(n,o.default),function(e,t,n){t&&a(e.prototype,t),n&&a(e,n)}(n,[{key:"get",value:function(e){return this.storage[e]}},{key:"set",value:function(e,t){return this.storage[e]=t,this}},{key:"remove",value:function(e){return delete this.storage[e],this}}]),n}();n.default=l},{"./base_storage":42}],46:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,o=(r=e("./base_storage"))&&r.__esModule?r:{default:r};function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l=function(){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=u(this,s(n).call(this,{}))).storages=e,t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(n,o.default),function(e,t,n){t&&a(e.prototype,t),n&&a(e,n)}(n,[{key:"get",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this.storages[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;if(a.has(e))return a.get(e)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}}},{key:"set",value:function(e,t){var n=!0,r=!1,o=void 0;try{for(var i,a=this.storages[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){i.value.set(e,t)}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return this}},{key:"remove",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this.storages[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){o.value.remove(e)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return this}}]),n}();n.default=l},{"./base_storage":42}],47:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=l(e("./../lib/object_assign")),r=l(e("./../lib/object_without")),a=l(e("./../lib/is_object")),u=e("./../lib/date_utils"),s=e("./../lib/id"),o=e("./../logger"),c=e("./../constants");function l(e){return e&&e.__esModule?e:{default:e}}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t,n){return t&&f(e.prototype,t),n&&f(e,n),e}(0,o.createLogger)("Aplaut Session");var h=function(){function o(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),this.storage=e,this.distinctId=t.distinctId,this.id=t.id,this.vars=t.vars||{},this.lastActivityAt=t.lastActivityAt,this.timeout=n.timeout}return p(o,null,[{key:"resumeOrNew",value:function(e,t,n){var r=e.get(c.SESSION_STORAGE_KEY)||{};return(0,i.default)(r,t),new o(e,r,n)}}]),p(o,[{key:"initialize",value:function(){this.isExpired()&&this.reset(),this.id||this.setId(),this.touchLastActivity(),this.save()}},{key:"reset",value:function(){this.setId(),this.lastActivityAt=null}},{key:"setId",value:function(){this.id=(0,s.generate)()}},{key:"setVars",value:function(e){if((0,a.default)(e)){var t=(0,i.default)({},this.vars,e);this.vars=t,this.save()}}},{key:"unsetVar",value:function(e){this.vars=(0,r.default)(this.vars,e),this.save()}},{key:"isExpired",value:function(){return!!this.lastActivityAt&&(0,u.nowUnixSeconds)()-this.timeout>this.lastActivityAt}},{key:"touchLastActivity",value:function(){this.lastActivityAt=(0,u.nowUnixSeconds)()}},{key:"save",value:function(){this.storage.set(c.SESSION_STORAGE_KEY,{id:this.id,vars:this.vars,lastActivityAt:this.lastActivityAt})}}]),o}();n.default=h},{"./../constants":13,"./../lib/date_utils":23,"./../lib/id":25,"./../lib/is_object":28,"./../lib/object_assign":31,"./../lib/object_without":33,"./../logger":38}],48:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=y(e("./../lib/object_assign")),r=y(e("./../lib/is_object")),o=e("./../lib/date_utils"),u=y(e("./transport")),s=y(e("./session")),c=e("./../lib/id"),l=e("./../page"),f=e("./../browser"),p=e("./../constants"),i=e("./../logger"),h=y(e("./../version")),d=y(e("../storage/multi_storage"));function y(e){return e&&e.__esModule?e:{default:e}}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(0,i.createLogger)("Aplaut Tracker");var g=function(){function i(e){var t=e.config,n=e.events,r=e.cookieStorage,o=e.localStorage;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),this.config=t,this.events=n,this.cookieStorage=r,this.localStorage=o,this.multiStorage=new d.default([r,o]),this.initialized=!1,this.sourceId=null,this.distinctId=null,this.traits=null,this.session=null,this.transport=null}return function(e,t,n){t&&b(e.prototype,t),n&&b(e,n)}(i,[{key:"initialize",value:function(){if(this.initialized)return!1;this.sourceId=this.config.sourceId,this.initializeProfile(),this.initializeSession(),this.initializeTransport(),this.handleExperimentsEvents(),this.initialized=!0}},{key:"setDistinctId",value:function(e){this.distinctId=e,this.multiStorage.set(p.DISTINCT_ID_STORAGE_KEY,e)}},{key:"getTraits",value:function(){var e=this.localStorage.get(p.TRAITS_STORAGE_KEY);return(0,r.default)(e)?e:{}}},{key:"setTraits",value:function(e){if((0,r.default)(e)){var t=(0,a.default)(this.traits,e);this.traits=t,this.localStorage.set(p.TRAITS_STORAGE_KEY,t)}}},{key:"identify",value:function(e,t){this.setDistinctId(e),t&&this.setTraits(t)}},{key:"reset",value:function(){this.setDistinctId(this.generateDistinctId()),this.session.reset()}},{key:"track",value:function(e,t){var n=1<arguments.length&&void 0!==t?t:{},r=this.composeMessage("track",e,n);this.transport.send(r),this.session.touchLastActivity(),this.session.save()}},{key:"page",value:function(e,t){var n=0<arguments.length&&void 0!==e?e:"Page",r=1<arguments.length&&void 0!==t?t:{};r=(0,a.default)({},(0,l.getInfo)(),r);var o=this.composeMessage("page",n,r);this.transport.send(o),this.session.touchLastActivity(),this.session.save()}},{key:"alias",value:function(e){var t=this.composeMessage("alias","alias",{alias:e});this.transport.send(t)}},{key:"set",value:function(e,t){"session"==e?this.setSessionVars(t):"profile"==e&&this.setTraits(t)}},{key:"setSessionVars",value:function(e){this.session.setVars(e)}},{key:"unsetSessionVar",value:function(e){this.session.unsetVar(e)}},{key:"composeMessage",value:function(e,t,n){var r=2<arguments.length&&void 0!==n?n:{};return{id:(0,c.generate)(),type:e,event:t,props:r,sourceId:this.config.sourceId,distinctId:this.distinctId,traits:this.traits,occuredAt:(0,o.nowISO8601)(),session:this.composeSession(),context:this.composeContext()}}},{key:"composeSession",value:function(){return{id:this.session.id,vars:this.session.vars}}},{key:"composeContext",value:function(){return{library:{name:"aplaut.js",version:h.default},browser:(0,f.getInfo)()}}},{key:"initializeProfile",value:function(){var e=this.multiStorage.get(p.DISTINCT_ID_STORAGE_KEY)||this.generateDistinctId();this.setDistinctId(e),this.traits=this.getTraits()}},{key:"initializeSession",value:function(){this.session=s.default.resumeOrNew(this.localStorage,{distinctId:this.distinctId},{timeout:this.config.sessionTimeout}),this.session.initialize()}},{key:"initializeTransport",value:function(){this.transport=new u.default(this.config.transport)}},{key:"generateDistinctId",value:function(){return(0,c.generate)()}},{key:"handleExperimentsEvents",value:function(){var r=this;this.events.on(p.EXPERIMENTS_STARTED_EVENT,function(e){var t=e.experiment,n=e.variant;r.setSessionVars(v({},"experiment:".concat(t.name),n.name)),r.track("Experiment Started",{experiment:t.name,variant:n.name})}),this.events.on(p.EXPERIMENTS_COMPLETED_EVENT,function(e){var t=e.experiment;r.unsetSessionVar("experiment:".concat(t.name)),r.track("Experiment Completed",{experiment:t.name})}),this.events.on(p.EXPERIMENTS_RUNNED_EVENT,function(e){var t=e.experiment,n=e.variant;r.setSessionVars(v({},"experiment:".concat(t.name),n.name))})}}]),i}();n.default=g},{"../storage/multi_storage":46,"./../browser":11,"./../constants":13,"./../lib/date_utils":23,"./../lib/id":25,"./../lib/is_object":28,"./../lib/object_assign":31,"./../logger":38,"./../page":40,"./../version":51,"./session":47,"./transport":49}],49:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=l(e("./../lib/object_assign")),a=l(e("./../lib/base64")),u=e("./../lib/date_utils"),o=l(e("url-parse")),s=l(e("promise-polyfill")),i=e("./../browser"),c=e("./../logger");function l(e){return e&&e.__esModule?e:{default:e}}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var p={server:"https://track.aplaut.io",maxGetMessageLength:1500},h=(0,c.createLogger)("Aplaut Transport"),d=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.options=(0,r.default)({},p,e)}return function(e,t,n){t&&f(e.prototype,t),n&&f(e,n)}(t,[{key:"send",value:function(e,t){h.debug("send",e);var n=JSON.stringify(e),r=a.default.encodeURI(n);if(r.length<=this.options.maxGetMessageLength){var o=this.makeURL("/v1/event",{data:r,ts:(0,u.nowUnixMilliseconds)()});return this.sendXHR("GET",o)}var i=this.makeURL("/v1/event");return this.sendXHR("POST",i,n)}},{key:"makeURL",value:function(e,t){var n=1<arguments.length&&void 0!==t?t:{},r=(0,o.default)(this.options.server);return r.pathname=e,r.query=n,r.toString()}},{key:"sendXHR",value:function(e,o,i){var a=this;return new s.default(function(t,n){function r(e){if(200!==e.status)return n(new Error("XHR request error"));try{return t(e.responseText)}catch(e){return n(e)}}a.createXHR(e,o).then(function(e){e.onload=function(){return r(e)},e.onerror=function(){return r(e)},e.send(i)}).catch(function(e){return n(e)})})}},{key:"createXHR",value:function(r,o){return new s.default(function(e,t){if(i.hasXHRWithCreds||!i.hasXDRSupport&&i.hasXHRSupport){var n=new i.win.XMLHttpRequest;n.open(r,o,!0),n.setRequestHeader("Content-Type","text/plain"),e(n)}else i.hasXDRSupport?setTimeout(function(){xhr=new i.win.XDomainRequest,xhr.ontimeout=noop(),xhr.onprogress=noop(),xhr.open(r,o,!0),e(xhr)},0):t(new Error("XHR isn't supported"))})}}]),t}();n.default=d},{"./../browser":11,"./../lib/base64":22,"./../lib/date_utils":23,"./../lib/object_assign":31,"./../logger":38,"promise-polyfill":5,"url-parse":9}],50:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var u=a(e("./tracking/tracker")),r=a(e("./base_app")),i=a(e("./lib/no_method")),o=a(e("./lib/is_function"));function a(e){return e&&e.__esModule?e:{default:e}}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var h=function(){function a(e){var t,n=e.events,r=e.config,o=e.cookieStorage,i=e.localStorage;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=l(this,f(a).call(this,{name:"Aplaut Tracking",events:n}))).config=r,t.tracker=new u.default({config:r,events:n,cookieStorage:o,localStorage:i}),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(a,r.default),function(e,t,n){t&&c(e.prototype,t),n&&c(e,n)}(a,[{key:"call",value:function(e){for(var t,n=arguments.length,r=new Array(1<n?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return this.logger.debug("call",e,r),"tracker"==e?this.tracker:this.hasMethod(e)?this.initialized?(t=this.tracker)[e].apply(t,r):this.queueCall.apply(this,[e].concat(r)):(0,i.default)(this.name,e)}},{key:"hasMethod",value:function(e){return(0,o.default)(this.tracker[e])}},{key:"onBeforeInitialize",value:function(){this.validateConfiguration(),this.tracker.initialize()}},{key:"validateConfiguration",value:function(){if(!this.config.sourceId)throw new Error("Aplaut.js tracker requires sourceId to be set")}}]),a}();n.default=h},{"./base_app":10,"./lib/is_function":27,"./lib/no_method":29,"./tracking/tracker":48}],51:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.VERSION=n.PATCH=n.MINOR=n.MAJOR=void 0;var r=0,o=0,i=1,a=[n.MAJOR=r,n.MINOR=o,n.PATCH=i].join("."),u=n.VERSION=a;n.default=u},{}]},{},[19]);